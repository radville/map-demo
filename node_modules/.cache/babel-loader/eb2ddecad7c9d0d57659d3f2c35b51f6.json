{"ast":null,"code":"// Adapted from \"Geometry Service - Calculate geometry\"\n// at https://developers.arcgis.com/javascript/3/jssamples/util_measurepoly.html\nimport React from 'react';\nimport { loadModules } from 'esri-loader';\n\nconst geometryService = () => {\n  console.log(\"here\");\n\n  require([\"dojo/dom\", \"dojo/_base/lang\", \"dojo/json\", \"esri/config\", \"esri/map\", \"esri/graphic\", \"esri/geometry/Geometry\", \"esri/geometry/Extent\", \"esri/SpatialReference\", \"esri/tasks/GeometryService\", \"esri/tasks/AreasAndLengthsParameters\", \"esri/toolbars/draw\", \"esri/symbols/SimpleFillSymbol\"], function (dom, lang, json, esriConfig, Map, Graphic, Geometry, Extent, SpatialReference, GeometryService, AreasAndLengthsParameters, Draw, SimpleFillSymbol) {\n    //identify proxy page to use if the toJson payload to the geometry service is greater than 2000 characters.\n    //If this null or not available the project and lengths operation will not work.  Otherwise it will do a http post to the proxy.\n    esriConfig.defaults.io.proxyUrl = \"/proxy/\";\n    esriConfig.defaults.io.alwaysUseProxy = false;\n    var map = new Map(\"mapDiv\", {\n      basemap: \"topo\",\n      center: [-122.778, 45.483],\n      zoom: 15\n    });\n    map.on(\"load\", function () {\n      var tb = new Draw(map);\n      tb.on(\"draw-end\", lang.hitch(map, getAreaAndLength));\n      tb.activate(Draw.FREEHAND_POLYGON);\n    });\n    var geometryService = new GeometryService(\"https://sampleserver6.arcgisonline.com/arcgis/rest/services/Utilities/Geometry/GeometryServer\");\n    geometryService.on(\"areas-and-lengths-complete\", outputAreaAndLength);\n\n    function getAreaAndLength(evtObj) {\n      var map = this,\n          geometry = evtObj.geometry;\n      map.graphics.clear();\n      var graphic = map.graphics.add(new Graphic(geometry, new SimpleFillSymbol())); //setup the parameters for the areas and lengths operation\n\n      var areasAndLengthParams = new AreasAndLengthsParameters();\n      areasAndLengthParams.lengthUnit = GeometryService.UNIT_FOOT;\n      areasAndLengthParams.areaUnit = GeometryService.UNIT_ACRES;\n      areasAndLengthParams.calculationType = \"geodesic\";\n      geometryService.simplify([geometry], function (simplifiedGeometries) {\n        areasAndLengthParams.polygons = simplifiedGeometries;\n        geometryService.areasAndLengths(areasAndLengthParams);\n      });\n    }\n\n    function outputAreaAndLength(evtObj) {\n      var result = evtObj.result;\n      console.log(json.stringify(result));\n      dom.byId(\"area\").innerHTML = result.areas[0].toFixed(3) + \" acres\";\n      dom.byId(\"length\").innerHTML = result.lengths[0].toFixed(3) + \" feet\";\n    }\n  });\n};\n\nexport default geometryService;","map":{"version":3,"sources":["/Users/Laura/Development/solar-calculator/src/scripts/geometryService.js"],"names":["React","loadModules","geometryService","console","log","require","dom","lang","json","esriConfig","Map","Graphic","Geometry","Extent","SpatialReference","GeometryService","AreasAndLengthsParameters","Draw","SimpleFillSymbol","defaults","io","proxyUrl","alwaysUseProxy","map","basemap","center","zoom","on","tb","hitch","getAreaAndLength","activate","FREEHAND_POLYGON","outputAreaAndLength","evtObj","geometry","graphics","clear","graphic","add","areasAndLengthParams","lengthUnit","UNIT_FOOT","areaUnit","UNIT_ACRES","calculationType","simplify","simplifiedGeometries","polygons","areasAndLengths","result","stringify","byId","innerHTML","areas","toFixed","lengths"],"mappings":"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","sourcesContent":["// Adapted from \"Geometry Service - Calculate geometry\"\n// at https://developers.arcgis.com/javascript/3/jssamples/util_measurepoly.html\nimport React from 'react';\nimport { loadModules } from 'esri-loader';\n\nconst geometryService = () => {\n    console.log(\"here\")\n\nrequire([\"dojo/dom\",\n          \"dojo/_base/lang\",\n          \"dojo/json\",\n          \"esri/config\",\n          \"esri/map\",\n          \"esri/graphic\",\n          \"esri/geometry/Geometry\",\n          \"esri/geometry/Extent\",\n          \"esri/SpatialReference\",\n          \"esri/tasks/GeometryService\",\n          \"esri/tasks/AreasAndLengthsParameters\",\n          \"esri/toolbars/draw\",\n          \"esri/symbols/SimpleFillSymbol\"],\n    function(dom, lang, json, esriConfig, Map, Graphic, Geometry, Extent, SpatialReference, GeometryService, AreasAndLengthsParameters, Draw, SimpleFillSymbol){\n\n      //identify proxy page to use if the toJson payload to the geometry service is greater than 2000 characters.\n      //If this null or not available the project and lengths operation will not work.  Otherwise it will do a http post to the proxy.\n      esriConfig.defaults.io.proxyUrl = \"/proxy/\";\n      esriConfig.defaults.io.alwaysUseProxy = false;\n\n      var map = new Map(\"mapDiv\", {\n        basemap: \"topo\",\n        center: [-122.778, 45.483],\n        zoom: 15\n      });\n      \n      map.on(\"load\", function() {\n        var tb = new Draw(map);\n        tb.on(\"draw-end\", lang.hitch(map, getAreaAndLength));\n        tb.activate(Draw.FREEHAND_POLYGON);\n      });\n      \n      var geometryService = new GeometryService(\"https://sampleserver6.arcgisonline.com/arcgis/rest/services/Utilities/Geometry/GeometryServer\");\n      geometryService.on(\"areas-and-lengths-complete\", outputAreaAndLength);\n\n    function getAreaAndLength(evtObj) {\n      var map = this,\n          geometry = evtObj.geometry;\n      map.graphics.clear();\n      \n      var graphic = map.graphics.add(new Graphic(geometry, new SimpleFillSymbol()));\n      \n      //setup the parameters for the areas and lengths operation\n      var areasAndLengthParams = new AreasAndLengthsParameters();\n      areasAndLengthParams.lengthUnit = GeometryService.UNIT_FOOT;\n      areasAndLengthParams.areaUnit = GeometryService.UNIT_ACRES;\n      areasAndLengthParams.calculationType = \"geodesic\";\n      geometryService.simplify([geometry], function(simplifiedGeometries) {\n        areasAndLengthParams.polygons = simplifiedGeometries;\n        geometryService.areasAndLengths(areasAndLengthParams);\n      });\n    }\n\n    function outputAreaAndLength(evtObj) {\n      var result = evtObj.result;\n      console.log(json.stringify(result));\n      dom.byId(\"area\").innerHTML = result.areas[0].toFixed(3) + \" acres\";\n      dom.byId(\"length\").innerHTML = result.lengths[0].toFixed(3) + \" feet\";\n    }\n  });\n}\n\nexport default geometryService;"]},"metadata":{},"sourceType":"module"}