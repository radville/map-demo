// COPYRIGHT Â© 2019 Esri
//
// All rights reserved under the copyright laws of the United States
// and applicable international laws, treaties, and conventions.
//
// This material is licensed for use under the Esri Master License
// Agreement (MLA), and is bound by the terms of that agreement.
// You may redistribute and use this code without modification,
// provided you adhere to the terms of the MLA and include this
// copyright notice.
//
// See use restrictions at http://www.esri.com/legal/pdfs/mla_e204_e300/english
//
// For additional information, contact:
// Environmental Systems Research Institute, Inc.
// Attn: Contracts and Legal Services Department
// 380 New York Street
// Redlands, California, USA 92373
// USA
//
// email: contracts@esri.com
//
// See http://js.arcgis.com/4.14/esri/copyright.txt for details.

define(["require","exports","./compilerUtils","./iteratorUtils","./jsonMap","./wgs84Constants","../geometry/support/WKIDUnitConversion"],function(e,s,t,r,i,n,a){function u(e,s,t){return e*E[t].units[s].inBaseUnits}function c(e,s,t){return e/E[t].units[s].inBaseUnits}function o(e){var s=A[e];if(s)return s;throw new Error("unknown measure")}function l(e){return E[e].baseUnit}function f(e){return l(o(e))}function m(e,s){return void 0===s&&(s=null),s=s||o(e),E[s].baseUnit===e}function U(e,s,t){if(s===t)return e;var r=o(s);if(r!==o(t))throw new Error("incompatible units");var i=m(s,r)?e:u(e,s,r);return m(t,r)?i:c(i,t,r)}function d(e,s){return U(e,s,"meters")<3e3?"meters":"kilometers"}function B(e,s){return U(e,s,"meters")<1e5?"meters":"kilometers"}function h(e,s){return U(e,s,"feet")<1e3?"feet":"miles"}function k(e,s){return U(e,s,"feet")<1e5?"feet":"miles"}function b(e,s){return U(e,s,"square-meters")<3e6?"square-meters":"square-kilometers"}function g(e,s){return U(e,s,"square-feet")<1e6?"square-feet":"square-miles"}function p(e,s,t){return void 0===t&&(t=n.wgs84Radius),U(e,s,"meters")/(t*Math.PI/180)}function y(e){return L.fromJSON(e.toLowerCase())||null}function q(e){return L.toJSON(e)||null}function v(e){var s=w(e);return s>1e5?1:s}function _(e){return w(e)>1e5?"meters":M(e)}function w(e,s){return void 0===s&&(s=R),S(e,!0)||s}function S(e,s){void 0===s&&(s=!1);var t,r,i;if(null!=e&&("object"==typeof e?(t=e.wkid,r=e.wkt):"number"==typeof e?t=e:"string"==typeof e&&(r=e)),t)!(i=O.values[O[t]])&&s&&J.has(t)&&(i=F);else if(r&&-1!==r.search(/^PROJCS/i)){var n=I.exec(r);n&&n[1]&&(i=parseFloat(n[1].split(",")[1]))}return i}function M(e){var s,t,r;if(null!=e&&("object"==typeof e?(s=e.wkid,t=e.wkt):"number"==typeof e?s=e:"string"==typeof e&&(t=e)),s)r=O.units[O[s]];else if(t&&-1!==t.search(/^PROJCS/i)){var i=I.exec(t);i&&i[1]&&(i=/[\\"\\']{1}([^\\"\\']+)/.exec(i[1]),r=i&&i[1])}return r?y(r):null}function P(e){if(!e)return null;var s=M(e);switch(s){case"feet":case"us-feet":case"clarke-feet":case"clarke-yards":case"clarke-links":case"sears-yards":case"sears-feet":case"sears-chains":case"benoit-1895-b-chains":case"indian-yards":case"indian-1937-yards":case"gold-coast-feet":case"sears-1922-truncated-chains":return"imperial";case"50-kilometers":case"150-kilometers":case"meters":return"metric";case null:case void 0:return null;default:t.neverReached(s)}return null}Object.defineProperty(s,"__esModule",{value:!0}),s.inchesPerMeter=39.37;var R=n.wgs84Radius*Math.PI/180,F=n.wgs84Radius*Math.PI/200,I=/UNIT\[([^\]]+)\]\]$/i,O=a,J=r.createSetFromValues([4261,4305,4807,4810,4811,4812,4816,4819,4821,4901,4902,37225,104139,104140]),L=i.strict()({meter:"meters",foot:"feet",foot_us:"us-feet",foot_clarke:"clarke-feet",yard_clarke:"clarke-yards",link_clarke:"clarke-links",yard_sears:"sears-yards",foot_sears:"sears-feet",chain_sears:"sears-chains",chain_benoit_1895_b:"benoit-1895-b-chains",yard_indian:"indian-yards",yard_indian_1937:"indian-1937-yards",foot_gold_coast:"gold-coast-feet",chain_sears_1922_truncated:"sears-1922-truncated-chains","50_kilometers":"50-kilometers","150_kilometers":"150-kilometers"}),C={millimeters:{inBaseUnits:.001},centimeters:{inBaseUnits:.01},decimeters:{inBaseUnits:.1},meters:{inBaseUnits:1},kilometers:{inBaseUnits:1e3},inches:{inBaseUnits:.0254},feet:{inBaseUnits:.3048},yards:{inBaseUnits:.9144},miles:{inBaseUnits:1609.344},"nautical-miles":{inBaseUnits:1852},"us-feet":{inBaseUnits:1200/3937}},N=function(e){return e*e},T={"square-millimeters":{inBaseUnits:N(.001)},"square-centimeters":{inBaseUnits:N(.01)},"square-decimeters":{inBaseUnits:N(.1)},"square-meters":{inBaseUnits:1},"square-kilometers":{inBaseUnits:N(1e3)},"square-inches":{inBaseUnits:N(.0254)},"square-feet":{inBaseUnits:N(.3048)},"square-yards":{inBaseUnits:N(.9144)},"square-miles":{inBaseUnits:N(1609.344)},"square-us-feet":{inBaseUnits:N(1200/3937)},acres:{inBaseUnits:.0015625*N(1609.344)},ares:{inBaseUnits:100},hectares:{inBaseUnits:1e4}},V=function(e){return e*e*e},j={liters:{inBaseUnits:1},"cubic-millimeters":{inBaseUnits:1e3*V(.001)},"cubic-centimeters":{inBaseUnits:1e3*V(.01)},"cubic-decimeters":{inBaseUnits:1e3*V(.1)},"cubic-meters":{inBaseUnits:1e3},"cubic-kilometers":{inBaseUnits:1e3*V(1e3)},"cubic-inches":{inBaseUnits:1e3*V(.0254)},"cubic-feet":{inBaseUnits:1e3*V(.3048)},"cubic-yards":{inBaseUnits:1e3*V(.9144)},"cubic-miles":{inBaseUnits:1e3*V(1609.344)}},x={radians:{inBaseUnits:1},degrees:{inBaseUnits:Math.PI/180}},E={length:{baseUnit:"meters",units:C},area:{baseUnit:"square-meters",units:T},volume:{baseUnit:"liters",units:j},angle:{baseUnit:"radians",units:x}},A=function(){var e={};for(var s in E)for(var t in E[s].units)e[t]=s;return e}();s.measurementAreaUnits=["metric","imperial","square-inches","square-feet","square-yards","square-miles","square-us-feet","square-meters","square-kilometers","acres","ares","hectares"],s.measurementLengthUnits=["metric","imperial","inches","feet","yards","miles","nautical-miles","us-feet","meters","kilometers"],s.measureForUnit=o,s.baseUnitForMeasure=l,s.baseUnitForUnit=f,s.isBaseUnit=m,s.convertUnit=U,s.preferredMetricLengthUnit=d,s.preferredMetricVerticalLengthUnit=B,s.preferredImperialLengthUnit=h,s.preferredImperialVerticalLengthUnit=k,s.preferredMetricAreaUnit=b,s.preferredImperialAreaUnit=g,s.lengthToDegrees=p,s.unitFromRESTJSON=y,s.unitToRESTJSON=q,s.getMetersPerVerticalUnitForSR=v,s.getVerticalUnitStringForSR=_,s.getMetersPerUnitForSR=w,s.getMetersPerUnit=S,s.getUnitString=M,s.getDefaultUnitSystem=P});