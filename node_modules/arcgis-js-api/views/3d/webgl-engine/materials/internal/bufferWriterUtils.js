// COPYRIGHT Â© 2019 Esri
//
// All rights reserved under the copyright laws of the United States
// and applicable international laws, treaties, and conventions.
//
// This material is licensed for use under the Esri Master License
// Agreement (MLA), and is bound by the terms of that agreement.
// You may redistribute and use this code without modification,
// provided you adhere to the terms of the MLA and include this
// copyright notice.
//
// See use restrictions at http://www.esri.com/legal/pdfs/mla_e204_e300/english
//
// For additional information, contact:
// Environmental Systems Research Institute, Inc.
// Attn: Contracts and Legal Services Department
// 380 New York Street
// Redlands, California, USA 92373
// USA
//
// email: contracts@esri.com
//
// See http://js.arcgis.com/4.14/esri/copyright.txt for details.

define(["require","exports","../../../support/buffer/BufferView","../../lib/Util"],function(e,r,f,t){function a(e,r,f,t,a){var i=f.typedBuffer,s=f.typedBufferStride,o=e.length;if(t*=s,null==a||1===a)for(var u=0;u<o;++u){var v=2*e[u];i[t]=r[v],i[t+1]=r[v+1],t+=s}else for(var u=0;u<o;++u)for(var v=2*e[u],n=0;n<a;++n)i[t]=r[v],i[t+1]=r[v+1],t+=s}function i(e,r,f,t,a){var i=f.typedBuffer,s=f.typedBufferStride,o=e.length;if(t*=s,null==a||1===a)for(var u=0;u<o;++u){var v=3*e[u];i[t]=r[v],i[t+1]=r[v+1],i[t+2]=r[v+2],t+=s}else for(var u=0;u<o;++u)for(var v=3*e[u],n=0;n<a;++n)i[t]=r[v],i[t+1]=r[v+1],i[t+2]=r[v+2],t+=s}function s(e,r,f,t,a){var i=f.typedBuffer,s=f.typedBufferStride,o=e.length;if(t*=s,null==a||1===a)for(var u=0;u<o;++u){var v=4*e[u];i[t]=r[v],i[t+1]=r[v+1],i[t+2]=r[v+2],i[t+3]=r[v+3],t+=s}else for(var u=0;u<o;++u)for(var v=4*e[u],n=0;n<a;++n)i[t]=r[v],i[t+1]=r[v+1],i[t+2]=r[v+2],i[t+3]=r[v+3],t+=s}function o(e,r,f,t){var a=f.typedBuffer,i=f.typedBufferStride,s=e.length;t*=i;for(var o=0;o<s;++o){for(var u=9*e[o],v=0;v<9;++v)a[t+v]=r[u+v];t+=i}}function u(e,r,f,t){var a=f.typedBuffer,i=f.typedBufferStride,s=e.length;t*=i;for(var o=0;o<s;++o){for(var u=16*e[o],v=0;v<16;++v)a[t+v]=r[u+v];t+=i}}function v(e,r,f,t,a,s){if(f){var o=f,u=t.typedBuffer,v=t.typedBufferStride,n=e.length;if(a*=v,null==s||1===s)for(var l=0;l<n;++l){var d=3*e[l],B=r[d],c=r[d+1],V=r[d+2];u[a]=o[0]*B+o[4]*c+o[8]*V+o[12],u[a+1]=o[1]*B+o[5]*c+o[9]*V+o[13],u[a+2]=o[2]*B+o[6]*c+o[10]*V+o[14],a+=v}else for(var l=0;l<n;++l)for(var d=3*e[l],B=r[d],c=r[d+1],V=r[d+2],p=o[0]*B+o[4]*c+o[8]*V+o[12],w=o[1]*B+o[5]*c+o[9]*V+o[13],y=o[2]*B+o[6]*c+o[10]*V+o[14],g=0;g<s;++g)u[a]=p,u[a+1]=w,u[a+2]=y,a+=v}else i(e,r,t,a,s)}function n(e,r,f,t,a,s){if(f){var o=f,u=t.typedBuffer,v=t.typedBufferStride,n=e.length;if(a*=v,null==s||1===s)for(var l=0;l<n;++l){var d=3*e[l],B=r[d],c=r[d+1],V=r[d+2];u[a]=o[0]*B+o[4]*c+o[8]*V,u[a+1]=o[1]*B+o[5]*c+o[9]*V,u[a+2]=o[2]*B+o[6]*c+o[10]*V,a+=v}else for(var l=0;l<n;++l)for(var d=3*e[l],B=r[d],c=r[d+1],V=r[d+2],p=o[0]*B+o[4]*c+o[8]*V,w=o[1]*B+o[5]*c+o[9]*V,y=o[2]*B+o[6]*c+o[10]*V,g=0;g<s;++g)u[a]=p,u[a+1]=w,u[a+2]=y,a+=v}else i(e,r,t,a,s)}function l(e,r,f,t,a,i){var s=t.typedBuffer,o=t.typedBufferStride,u=e.length;if(a*=o,null==i||1===i){if(4===f)for(var v=0;v<u;++v){var n=4*e[v];s[a]=r[n],s[a+1]=r[n+1],s[a+2]=r[n+2],s[a+3]=r[n+3],a+=o}else if(3===f)for(var v=0;v<u;++v){var n=3*e[v];s[a]=r[n],s[a+1]=r[n+1],s[a+2]=r[n+2],s[a+3]=255,a+=o}}else if(4===f)for(var v=0;v<u;++v)for(var n=4*e[v],l=0;l<i;++l)s[a]=r[n],s[a+1]=r[n+1],s[a+2]=r[n+2],s[a+3]=r[n+3],a+=o;else if(3===f)for(var v=0;v<u;++v)for(var n=3*e[v],l=0;l<i;++l)s[a]=r[n],s[a+1]=r[n+1],s[a+2]=r[n+2],s[a+3]=255,a+=o}function d(e,r,f,t,a,i,s){var o=a.typedBuffer,u=a.typedBufferStride,v=e.length;if(i*=u,null==s||1===s){if(4===f)for(var n=0;n<v;++n){var l=4*e[n];o[i]=r[l]*t[0],o[i+1]=r[l+1]*t[1],o[i+2]=r[l+2]*t[2],o[i+3]=r[l+3]*t[3],i+=u}else if(3===f)for(var d=255*t[3],n=0;n<v;++n){var l=3*e[n];o[i]=r[l]*t[0],o[i+1]=r[l+1]*t[1],o[i+2]=r[l+2]*t[2],o[i+3]=d,i+=u}}else if(4===f)for(var n=0;n<v;++n)for(var l=4*e[n],B=0;B<s;++B)o[i]=r[l]*t[0],o[i+1]=r[l+1]*t[1],o[i+2]=r[l+2]*t[2],o[i+3]=r[l+3]*t[3],i+=u;else if(3===f)for(var d=255*t[3],n=0;n<v;++n)for(var l=3*e[n],B=0;B<s;++B)o[i]=r[l]*t[0],o[i+1]=r[l+1]*t[1],o[i+2]=r[l+2]*t[2],o[i+3]=d,i+=u}function B(e,r,i,o,u,d){for(var B=0,c=r.fieldNames;B<c.length;B++){var V=c[B],p=e.vertexAttr[V],w=e.indices[V];if(p&&w)switch(V){case t.VertexAttrConstants.POSITION:t.assert(3===p.size);var y=u.getField(V,f.BufferViewVec3f);y&&v(w,p.data,i,y,d);break;case t.VertexAttrConstants.NORMAL:t.assert(3===p.size);var g=u.getField(V,f.BufferViewVec3f);g&&n(w,p.data,o,g,d);break;case t.VertexAttrConstants.UV0:t.assert(2===p.size);var h=u.getField(V,f.BufferViewVec2f);h&&a(w,p.data,h,d);break;case t.VertexAttrConstants.REGION:t.assert(4===p.size);var z=u.getField(V,f.BufferViewVec4u16);z&&s(w,p.data,z,d);break;case t.VertexAttrConstants.COLOR:t.assert(3===p.size||4===p.size);var A=u.getField(V,f.BufferViewVec4u8);A&&l(w,p.data,p.size,A,d);break;case t.VertexAttrConstants.SYMBOLCOLOR:t.assert(3===p.size||4===p.size);var C=u.getField(V,f.BufferViewVec4u8);C&&l(w,p.data,p.size,C,d);break;case t.VertexAttrConstants.TANGENT:t.assert(4===p.size);var S=u.getField(V,f.BufferViewVec4f);S&&s(w,p.data,S,d)}}}Object.defineProperty(r,"__esModule",{value:!0}),r.writeBufferVec2=a,r.writeBufferVec3=i,r.writeBufferVec4=s,r.writeBufferMat3f=o,r.writeBufferMat4f=u,r.writePosition=v,r.writeNormal=n,r.writeColor=l,r.writeMultipliedColor=d,r.writeDefaultAttributes=B});