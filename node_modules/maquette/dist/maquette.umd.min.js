!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?r(exports):"function"==typeof define&&define.amd?define(["exports"],r):r((e=e||self).maquette={})}(this,function(e){"use strict";function l(r,t){var n={};return Object.keys(r).forEach(function(e){n[e]=r[e]}),t&&Object.keys(t).forEach(function(e){n[e]=t[e]}),n}function v(e,r){return e.vnodeSelector===r.vnodeSelector&&(e.properties&&r.properties?e.properties.key===r.properties.key&&e.properties.bind===r.properties.bind:!e.properties&&!r.properties)}function A(e){if("string"!=typeof e)throw Error("Style values must be strings")}function h(e,r,t){if(""!==r.vnodeSelector)for(var n=t;n<e.length;n++)if(v(e[n],r))return n;return-1}function m(e,r,t,n){var o=e[r];if(""!==o.vnodeSelector){var i=o.properties;if(!(i?void 0===i.key?i.bind:i.key:void 0))for(var d=0;d<e.length;d++)if(d!==r&&v(e[d],o))throw Error(t.vnodeSelector+" had a "+o.vnodeSelector+" child "+("added"===n?n:"removed")+", but there is now more than one. You must add unique key properties to make them distinguishable.")}}function g(e){if(e.properties){var r=e.properties.enterAnimation;r&&r(e.domNode,e.properties)}}function r(){i=!1,o.forEach(d),o.length=0}function n(e){o.push(e),i||(i=!0,"undefined"!=typeof window&&"requestIdleCallback"in window?window.requestIdleCallback(r,{timeout:16}):setTimeout(r,16))}function y(e){var r=e.domNode;if(e.properties){var t=e.properties.exitAnimation;if(t)return r.style.pointerEvents="none",void t(r,function(){r.parentNode&&(r.parentNode.removeChild(r),n(e))},e.properties)}r.parentNode&&(r.parentNode.removeChild(r),n(e))}function u(e,r,t){!function(e,r,t){if(r)for(var n=0,o=r;n<o.length;n++){var i=o[n];w(i,e,void 0,t)}}(e,r.children,t),r.text&&(e.textContent=r.text),function(u,v,h){if(v)for(var m=h.eventHandlerInterceptor,g=Object.keys(v),e=g.length,r=function(e){var r,t=g[e],n=v[t];if("className"===t)throw Error('Property "className" is not supported, use "class".');if("class"===t)E(u,n,!0);else if("classes"===t)for(var o=Object.keys(n),i=o.length,d=0;d<i;d++){var a=o[d];n[a]&&u.classList.add(a)}else if("styles"===t){var p=Object.keys(n),s=p.length;for(d=0;d<s;d++){var c=p[d],f=n[c];f&&(A(f),h.styleApplyer(u,c,f))}}else if("key"!==t&&null!=n){var l=typeof n;"function"==l?t.lastIndexOf("on",0)||(m&&(n=m(t,n,u,v)),"oninput"===t&&(r=n,n=function(e){r.call(this,e),e.target["oninput-value"]=e.target.value}),u[t]=n):h.namespace===S?"href"===t?u.setAttributeNS(k,t,n):u.setAttribute(t,n):"string"==l&&"value"!==t&&"innerHTML"!==t?u.setAttribute(t,n):u[t]=n}},t=0;t<e;t++)r(t)}(e,r.properties,t),r.properties&&r.properties.afterCreate&&r.properties.afterCreate.call(r.properties.bind||r.properties,e,t,r.vnodeSelector,r.properties,r.children)}var N,t="http://www.w3.org/",S=t+"2000/svg",k=t+"1999/xlink",b=[],o=[],i=!1,d=function(e){(e.children||[]).forEach(d),e.properties&&e.properties.afterRemoved&&e.properties.afterRemoved.call(e.properties.bind||e.properties,e.domNode)},w=function(e,r,t,n){var o,i=0,d=e.vnodeSelector,a=r.ownerDocument;if(""===d)o=e.domNode=a.createTextNode(e.text),void 0!==t?r.insertBefore(o,t):r.appendChild(o);else{for(var p=0;p<=d.length;++p){var s=d[0|p];if(p===d.length||"."==s||"#"==s){var c=d[0|i-1],f=d.slice(i,p);"."==c?o.classList.add(f):"#"==c?o.id=f:("svg"===f&&(n=l(n,{namespace:S})),void 0!==n.namespace?o=e.domNode=a.createElementNS(n.namespace,f):(o=e.domNode=e.domNode||a.createElement(f),"input"===f&&e.properties&&void 0!==e.properties.type&&o.setAttribute("type",e.properties.type)),void 0!==t?r.insertBefore(o,t):o.parentNode!==r&&r.appendChild(o)),i=p+1}}u(o,e,n)}},E=function(r,e,t){e&&e.split(" ").forEach(function(e){e&&r.classList.toggle(e,t)})};function a(r,t){return{getLastRender:function(){return r},update:function(e){if(r.vnodeSelector!==e.vnodeSelector)throw Error("The selector for the root VNode may not be changed. (consider using dom.merge and add one extra level to the virtual DOM)");N(r,r=e,t)},domNode:r.domNode}}function p(e){return l(s,e)}N=function(e,r,t){var n=e.domNode;if(e===r)return!1;var o=!1;if(""===r.vnodeSelector){if(r.text!==e.text){var i=n.ownerDocument.createTextNode(r.text);return n.parentNode.replaceChild(i,n),r.domNode=i,!0}r.domNode=n}else r.vnodeSelector.lastIndexOf("svg",0)||(t=l(t,{namespace:S})),e.text!==r.text&&(o=!0,void 0===r.text?n.removeChild(n.firstChild):n.textContent=r.text),r.domNode=n,o=function(e,r,t,n,o){if(t===n)return!1;n=n||b;for(var i,d=(t=t||b).length,a=n.length,p=0,s=0,c=!1;s<a;){var f=p<d?t[p]:void 0,l=n[s];if(void 0!==f&&v(f,l))c=N(f,l,o)||c,p++;else{var u=h(t,l,p+1);if(u<0)w(l,r,p<d?t[p].domNode:void 0,o),g(l),m(n,s,e,"added");else{for(i=p;i<u;i++)y(t[i]),m(t,i,e,"removed");c=N(t[u],l,o)||c,p=u+1}}s++}if(p<d)for(i=p;i<d;i++)y(t[i]),m(t,i,e,"removed");return c}(r,n,e.children,r.children,t)||o,o=function(e,r,t,n){if(t){for(var o=!1,i=Object.keys(t),d=i.length,a=0;a<d;a++){var p=i[a],s=t[p],c=r[p];if("class"===p)c!==s&&(E(e,c,!1),E(e,s,!0));else if("classes"===p)for(var f=e.classList,l=Object.keys(s),u=l.length,v=0;v<u;v++){var h=l[v],m=!!s[h];m!=!!c[h]&&(o=!0,m?f.add(h):f.remove(h))}else if("styles"===p){var g=Object.keys(s),y=g.length;for(v=0;v<y;v++){var N=g[v],b=s[N];b!==c[N]&&(o=!0,b?(A(b),n.styleApplyer(e,N,b)):n.styleApplyer(e,N,""))}}else if(s||"string"!=typeof c||(s=""),"value"===p){var w=e[p];w!==s&&(e["oninput-value"]?w===e["oninput-value"]:s!==c)&&(e[p]=s,e["oninput-value"]=void 0),s!==c&&(o=!0)}else if(s!==c){var x=typeof s;"function"==x&&n.eventHandlerInterceptor||(n.namespace===S?"href"===p?e.setAttributeNS(k,p,s):e.setAttribute(p,s):"string"==x&&"innerHTML"!==p?"role"===p&&""===s?e.removeAttribute(p):e.setAttribute(p,s):e[p]!==s&&(e[p]=s),o=!0)}}return o}}(n,e.properties,r.properties,t)||o,r.properties&&r.properties.afterUpdate&&r.properties.afterUpdate.call(r.properties.bind||r.properties,n,t,r.vnodeSelector,r.properties,r.children);return o&&r.properties&&r.properties.updateAnimation&&r.properties.updateAnimation(n,r.properties,e.properties),!1};var x,s={namespace:void 0,performanceLogger:function(){},eventHandlerInterceptor:void 0,styleApplyer:function(e,r,t){e.style[r]=t}},C={create:function(e,r){return r=p(r),w(e,document.createElement("div"),void 0,r),a(e,r)},append:function(e,r,t){return t=p(t),w(r,e,void 0,t),a(r,t)},insertBefore:function(e,r,t){return t=p(t),w(r,e.parentNode,e,t),a(r,t)},merge:function(e,r,t){return t=p(t),u(r.domNode=e,r,t),a(r,t)},replace:function(e,r,t){return t=p(t),w(r,e.parentNode,e,t),e.parentNode.removeChild(e),a(r,t)}},c=function(e,r,t){for(var n=0,o=r.length;n<o;n++){var i=r[n];Array.isArray(i)?c(e,i,t):null!=i&&!1!==i&&("string"==typeof i&&(i={vnodeSelector:"",properties:void 0,children:void 0,text:i.toString(),domNode:null}),t.push(i))}};x=Array.prototype.find?function(e,r){return e.find(r)}:function(e,r){return e.filter(r)[0]},e.createCache=function(){var n,o;return{invalidate:function(){n=o=void 0},result:function(e,r){if(n)for(var t=0;t<e.length;t++)n[t]!==e[t]&&(o=void 0);return o||(o=r(),n=e),o}}},e.createMapping=function(c,f,l){var u=[],v=[];return{results:v,map:function(e){for(var r=e.map(c),t=v.slice(),n=0,o=0;o<e.length;o++){var i=e[o],d=r[o];if(d===u[n])v[o]=t[n],l(i,t[n],o),n++;else{for(var a=!1,p=1;p<u.length+1;p++){var s=(n+p)%u.length;if(u[s]===d){v[o]=t[s],l(e[o],t[s],o),n=1+s,a=!0;break}}a||(v[o]=f(i,o))}}v.length=e.length,u=r}}},e.createProjector=function(e){function t(e,r,t){var d,a,p;function o(e){p("domEvent",e);var r=d,t=function(e,r){for(var t=[];e!==r;)t.push(e),e=e.parentNode;return t}(e.currentTarget,r.domNode);t.reverse();var n,o,i=(o=r.getLastRender(),t.forEach(function(r){o=o&&o.children?x(o.children,function(e){return e.domNode===r}):void 0}),o);return a.scheduleRender(),i&&(n=i.properties["on"+e.type].apply(i.properties.bind||this,arguments)),p("domEventProcessed",e),n}i.eventHandlerInterceptor=(a=n,p=s,function(e,r,t,n){return o}),d=e(r,t(),i),c.push(d),f.push(t)}function r(){if(o=void 0,d){d=!1,s("renderStart",void 0);for(var e=0;e<c.length;e++){var r=f[e]();s("rendered",void 0),c[e].update(r),s("patched",void 0)}s("renderDone",void 0),d=!0}}var n,o,i=p(e),s=i.performanceLogger,d=!0,a=!1,c=[],f=[];return n={renderNow:r,scheduleRender:function(){o||a||(o=requestAnimationFrame(r))},stop:function(){o&&(cancelAnimationFrame(o),o=void 0),a=!0},resume:function(){d=!(a=!1),n.scheduleRender()},append:function(e,r){t(C.append,e,r)},insertBefore:function(e,r){t(C.insertBefore,e,r)},merge:function(e,r){t(C.merge,e,r)},replace:function(e,r){t(C.replace,e,r)},detach:function(e){for(var r=0;r<f.length;r++)if(f[r]===e)return f.splice(r,1),c.splice(r,1)[0];throw Error("renderFunction was not found")}}},e.dom=C,e.h=function(e,r,t){if(Array.isArray(r))t=r,r=void 0;else if(r&&("string"==typeof r||r.hasOwnProperty("vnodeSelector"))||t&&("string"==typeof t||t.hasOwnProperty("vnodeSelector")))throw Error("h called with invalid arguments");var n,o;return t&&1===t.length&&"string"==typeof t[0]?n=t[0]:t&&(c(e,t,o=[]),0===o.length&&(o=void 0)),{vnodeSelector:e,properties:r,children:o,text:""===n?void 0:n,domNode:null}},Object.defineProperty(e,"__esModule",{value:!0})});